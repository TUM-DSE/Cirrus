#![no_std]
#![no_main]

use aya_ebpf::cty::{c_long, c_char};
use core::mem;
use aya_ebpf::macros::map;
use aya_ebpf::helpers::bpf_printk;
use aya_ebpf::helpers::gen::bpf_ktime_get_ns;
use aya_ebpf::maps::{Array, HashMap};
use bpf_element::{BpfContext, update_checksum_ip};
use network_types::eth::{EthHdr, EtherType};
use network_types::ip::{IpProto, Ipv4Hdr};
use network_types::tcp::TcpHdr;
use network_types::udp::UdpHdr;
use bpf_element::filter::FilterResult;

const PACKET_START: usize = 0; // 14 if ethernet has not been stripped
//
#[no_mangle]
#[link_section = "bpffilter"]
pub extern "C" fn main(ctx: *mut BpfContext) -> FilterResult {
    let mut ctx = unsafe { *ctx };
    // unsafe { bpf_printk!(b"port %d\n", ctx.port) };
    try_classify(&mut ctx).unwrap_or_else(|_| FilterResult::Drop)
}

#[inline(always)]
fn try_classify(ctx: &mut BpfContext) -> Result<FilterResult, ()> {
    let ipv4hdr: *mut Ipv4Hdr = unsafe { ctx.get_ptr_mut(PACKET_START)? };
    let proto = unsafe { *ipv4hdr }.proto;
    let (src_port, dst_port) = match proto {
        IpProto::Tcp => {
            // unsafe { bpf_printk!(b"foo #2.1\n") };
            let tcphdr: *const TcpHdr = unsafe { ctx.get_ptr(PACKET_START + Ipv4Hdr::LEN) }?;
            (u16::from_be(unsafe { *tcphdr }.source), u16::from_be(unsafe { *tcphdr }.dest))
        }
        IpProto::Udp => {
            let udphdr: *const UdpHdr = unsafe { ctx.get_ptr(PACKET_START + Ipv4Hdr::LEN) }?;
            (u16::from_be(unsafe { *udphdr}.source), u16::from_be(unsafe { *udphdr }.dest))
        }
        _ => {
            // unsafe { bpf_printk!(b"err! #1\n") };
            return Err(())
        },
    };

    // in vim, mark a block of numbers and increment them sequentially with g<C-a> (vim may hang
    // for some time)
    Ok(match dst_port {
        1001 => FilterResult::Pass,
        1002 => FilterResult::Drop,
        1003 => FilterResult::Pass,
        1004 => FilterResult::Drop,
        1005 => FilterResult::Pass,
        1006 => FilterResult::Drop,
        1007 => FilterResult::Pass,
        1008 => FilterResult::Drop,
        1009 => FilterResult::Pass,
        1010 => FilterResult::Drop,
        1011 => FilterResult::Pass,
        1012 => FilterResult::Drop,
        1013 => FilterResult::Pass,
        1014 => FilterResult::Drop,
        1015 => FilterResult::Pass,
        1016 => FilterResult::Drop,
        1017 => FilterResult::Pass,
        1018 => FilterResult::Drop,
        1019 => FilterResult::Pass,
        1020 => FilterResult::Drop,
        1021 => FilterResult::Pass,
        1022 => FilterResult::Drop,
        1023 => FilterResult::Pass,
        1024 => FilterResult::Drop,
        1025 => FilterResult::Pass,
        1026 => FilterResult::Drop,
        1027 => FilterResult::Pass,
        1028 => FilterResult::Drop,
        1029 => FilterResult::Pass,
        1030 => FilterResult::Drop,
        1031 => FilterResult::Pass,
        1032 => FilterResult::Drop,
        1033 => FilterResult::Pass,
        1034 => FilterResult::Drop,
        1035 => FilterResult::Pass,
        1036 => FilterResult::Drop,
        1037 => FilterResult::Pass,
        1038 => FilterResult::Drop,
        1039 => FilterResult::Pass,
        1040 => FilterResult::Drop,
        1041 => FilterResult::Pass,
        1042 => FilterResult::Drop,
        1043 => FilterResult::Pass,
        1044 => FilterResult::Drop,
        1045 => FilterResult::Pass,
        1046 => FilterResult::Drop,
        1047 => FilterResult::Pass,
        1048 => FilterResult::Drop,
        1049 => FilterResult::Pass,
        1050 => FilterResult::Drop,
        1051 => FilterResult::Pass,
        1052 => FilterResult::Drop,
        1053 => FilterResult::Pass,
        1054 => FilterResult::Drop,
        1055 => FilterResult::Pass,
        1056 => FilterResult::Drop,
        1057 => FilterResult::Pass,
        1058 => FilterResult::Drop,
        1059 => FilterResult::Pass,
        1060 => FilterResult::Drop,
        1061 => FilterResult::Pass,
        1062 => FilterResult::Drop,
        1063 => FilterResult::Pass,
        1064 => FilterResult::Drop,
        1065 => FilterResult::Pass,
        1066 => FilterResult::Drop,
        1067 => FilterResult::Pass,
        1068 => FilterResult::Drop,
        1069 => FilterResult::Pass,
        1070 => FilterResult::Drop,
        1071 => FilterResult::Pass,
        1072 => FilterResult::Drop,
        1073 => FilterResult::Pass,
        1074 => FilterResult::Drop,
        1075 => FilterResult::Pass,
        1076 => FilterResult::Drop,
        1077 => FilterResult::Pass,
        1078 => FilterResult::Drop,
        1079 => FilterResult::Pass,
        1080 => FilterResult::Drop,
        1081 => FilterResult::Pass,
        1082 => FilterResult::Drop,
        1083 => FilterResult::Pass,
        1084 => FilterResult::Drop,
        1085 => FilterResult::Pass,
        1086 => FilterResult::Drop,
        1087 => FilterResult::Pass,
        1088 => FilterResult::Drop,
        1089 => FilterResult::Pass,
        1090 => FilterResult::Drop,
        1091 => FilterResult::Pass,
        1092 => FilterResult::Drop,
        1093 => FilterResult::Pass,
        1094 => FilterResult::Drop,
        1095 => FilterResult::Pass,
        1096 => FilterResult::Drop,
        1097 => FilterResult::Pass,
        1098 => FilterResult::Drop,
        1099 => FilterResult::Pass,
        1100 => FilterResult::Drop,
        1101 => FilterResult::Pass,
        1102 => FilterResult::Drop,
        1103 => FilterResult::Pass,
        1104 => FilterResult::Drop,
        1105 => FilterResult::Pass,
        1106 => FilterResult::Drop,
        1107 => FilterResult::Pass,
        1108 => FilterResult::Drop,
        1109 => FilterResult::Pass,
        1110 => FilterResult::Drop,
        1111 => FilterResult::Pass,
        1112 => FilterResult::Drop,
        1113 => FilterResult::Pass,
        1114 => FilterResult::Drop,
        1115 => FilterResult::Pass,
        1116 => FilterResult::Drop,
        1117 => FilterResult::Pass,
        1118 => FilterResult::Drop,
        1119 => FilterResult::Pass,
        1120 => FilterResult::Drop,
        1121 => FilterResult::Pass,
        1122 => FilterResult::Drop,
        1123 => FilterResult::Pass,
        1124 => FilterResult::Drop,
        1125 => FilterResult::Pass,
        1126 => FilterResult::Drop,
        1127 => FilterResult::Pass,
        1128 => FilterResult::Drop,
        1129 => FilterResult::Pass,
        1130 => FilterResult::Drop,
        1131 => FilterResult::Pass,
        1132 => FilterResult::Drop,
        1133 => FilterResult::Pass,
        1134 => FilterResult::Drop,
        1135 => FilterResult::Pass,
        1136 => FilterResult::Drop,
        1137 => FilterResult::Pass,
        1138 => FilterResult::Drop,
        1139 => FilterResult::Pass,
        1140 => FilterResult::Drop,
        1141 => FilterResult::Pass,
        1142 => FilterResult::Drop,
        1143 => FilterResult::Pass,
        1144 => FilterResult::Drop,
        1145 => FilterResult::Pass,
        1146 => FilterResult::Drop,
        1147 => FilterResult::Pass,
        1148 => FilterResult::Drop,
        1149 => FilterResult::Pass,
        1150 => FilterResult::Drop,
        1151 => FilterResult::Pass,
        1152 => FilterResult::Drop,
        1153 => FilterResult::Pass,
        1154 => FilterResult::Drop,
        1155 => FilterResult::Pass,
        1156 => FilterResult::Drop,
        1157 => FilterResult::Pass,
        1158 => FilterResult::Drop,
        1159 => FilterResult::Pass,
        1160 => FilterResult::Drop,
        1161 => FilterResult::Pass,
        1162 => FilterResult::Drop,
        1163 => FilterResult::Pass,
        1164 => FilterResult::Drop,
        1165 => FilterResult::Pass,
        1166 => FilterResult::Drop,
        1167 => FilterResult::Pass,
        1168 => FilterResult::Drop,
        1169 => FilterResult::Pass,
        1170 => FilterResult::Drop,
        1171 => FilterResult::Pass,
        1172 => FilterResult::Drop,
        1173 => FilterResult::Pass,
        1174 => FilterResult::Drop,
        1175 => FilterResult::Pass,
        1176 => FilterResult::Drop,
        1177 => FilterResult::Pass,
        1178 => FilterResult::Drop,
        1179 => FilterResult::Pass,
        1180 => FilterResult::Drop,
        1181 => FilterResult::Pass,
        1182 => FilterResult::Drop,
        1183 => FilterResult::Pass,
        1184 => FilterResult::Drop,
        1185 => FilterResult::Pass,
        1186 => FilterResult::Drop,
        1187 => FilterResult::Pass,
        1188 => FilterResult::Drop,
        1189 => FilterResult::Pass,
        1190 => FilterResult::Drop,
        1191 => FilterResult::Pass,
        1192 => FilterResult::Drop,
        1193 => FilterResult::Pass,
        1194 => FilterResult::Drop,
        1195 => FilterResult::Pass,
        1196 => FilterResult::Drop,
        1197 => FilterResult::Pass,
        1198 => FilterResult::Drop,
        1199 => FilterResult::Pass,
        1200 => FilterResult::Drop,
        1201 => FilterResult::Pass,
        1202 => FilterResult::Drop,
        1203 => FilterResult::Pass,
        1204 => FilterResult::Drop,
        1205 => FilterResult::Pass,
        1206 => FilterResult::Drop,
        1207 => FilterResult::Pass,
        1208 => FilterResult::Drop,
        1209 => FilterResult::Pass,
        1210 => FilterResult::Drop,
        1211 => FilterResult::Pass,
        1212 => FilterResult::Drop,
        1213 => FilterResult::Pass,
        1214 => FilterResult::Drop,
        1215 => FilterResult::Pass,
        1216 => FilterResult::Drop,
        1217 => FilterResult::Pass,
        1218 => FilterResult::Drop,
        1219 => FilterResult::Pass,
        1220 => FilterResult::Drop,
        1221 => FilterResult::Pass,
        1222 => FilterResult::Drop,
        1223 => FilterResult::Pass,
        1224 => FilterResult::Drop,
        1225 => FilterResult::Pass,
        1226 => FilterResult::Drop,
        1227 => FilterResult::Pass,
        1228 => FilterResult::Drop,
        1229 => FilterResult::Pass,
        1230 => FilterResult::Drop,
        1231 => FilterResult::Pass,
        1232 => FilterResult::Drop,
        1233 => FilterResult::Pass,
        1234 => FilterResult::Drop,
        1235 => FilterResult::Pass,
        1236 => FilterResult::Drop,
        1237 => FilterResult::Pass,
        1238 => FilterResult::Drop,
        1239 => FilterResult::Pass,
        1240 => FilterResult::Drop,
        1241 => FilterResult::Pass,
        1242 => FilterResult::Drop,
        1243 => FilterResult::Pass,
        1244 => FilterResult::Drop,
        1245 => FilterResult::Pass,
        1246 => FilterResult::Drop,
        1247 => FilterResult::Pass,
        1248 => FilterResult::Drop,
        1249 => FilterResult::Pass,
        1250 => FilterResult::Drop,
        1251 => FilterResult::Pass,
        1252 => FilterResult::Drop,
        1253 => FilterResult::Pass,
        1254 => FilterResult::Drop,
        1255 => FilterResult::Pass,
        1256 => FilterResult::Drop,
        1257 => FilterResult::Pass,
        1258 => FilterResult::Drop,
        1259 => FilterResult::Pass,
        1260 => FilterResult::Drop,
        1261 => FilterResult::Pass,
        1262 => FilterResult::Drop,
        1263 => FilterResult::Pass,
        1264 => FilterResult::Drop,
        1265 => FilterResult::Pass,
        1266 => FilterResult::Drop,
        1267 => FilterResult::Pass,
        1268 => FilterResult::Drop,
        1269 => FilterResult::Pass,
        1270 => FilterResult::Drop,
        1271 => FilterResult::Pass,
        1272 => FilterResult::Drop,
        1273 => FilterResult::Pass,
        1274 => FilterResult::Drop,
        1275 => FilterResult::Pass,
        1276 => FilterResult::Drop,
        1277 => FilterResult::Pass,
        1278 => FilterResult::Drop,
        1279 => FilterResult::Pass,
        1280 => FilterResult::Drop,
        1281 => FilterResult::Pass,
        1282 => FilterResult::Drop,
        1283 => FilterResult::Pass,
        1284 => FilterResult::Drop,
        1285 => FilterResult::Pass,
        1286 => FilterResult::Drop,
        1287 => FilterResult::Pass,
        1288 => FilterResult::Drop,
        1289 => FilterResult::Pass,
        1290 => FilterResult::Drop,
        1291 => FilterResult::Pass,
        1292 => FilterResult::Drop,
        1293 => FilterResult::Pass,
        1294 => FilterResult::Drop,
        1295 => FilterResult::Pass,
        1296 => FilterResult::Drop,
        1297 => FilterResult::Pass,
        1298 => FilterResult::Drop,
        1299 => FilterResult::Pass,
        1300 => FilterResult::Drop,
        1301 => FilterResult::Pass,
        1302 => FilterResult::Drop,
        1303 => FilterResult::Pass,
        1304 => FilterResult::Drop,
        1305 => FilterResult::Pass,
        1306 => FilterResult::Drop,
        1307 => FilterResult::Pass,
        1308 => FilterResult::Drop,
        1309 => FilterResult::Pass,
        1310 => FilterResult::Drop,
        1311 => FilterResult::Pass,
        1312 => FilterResult::Drop,
        1313 => FilterResult::Pass,
        1314 => FilterResult::Drop,
        1315 => FilterResult::Pass,
        1316 => FilterResult::Drop,
        1317 => FilterResult::Pass,
        1318 => FilterResult::Drop,
        1319 => FilterResult::Pass,
        1320 => FilterResult::Drop,
        1321 => FilterResult::Pass,
        1322 => FilterResult::Drop,
        1323 => FilterResult::Pass,
        1324 => FilterResult::Drop,
        1325 => FilterResult::Pass,
        1326 => FilterResult::Drop,
        1327 => FilterResult::Pass,
        1328 => FilterResult::Drop,
        1329 => FilterResult::Pass,
        1330 => FilterResult::Drop,
        1331 => FilterResult::Pass,
        1332 => FilterResult::Drop,
        1333 => FilterResult::Pass,
        1334 => FilterResult::Drop,
        1335 => FilterResult::Pass,
        1336 => FilterResult::Drop,
        1337 => FilterResult::Pass,
        1338 => FilterResult::Drop,
        1339 => FilterResult::Pass,
        1340 => FilterResult::Drop,
        1341 => FilterResult::Pass,
        1342 => FilterResult::Drop,
        1343 => FilterResult::Pass,
        1344 => FilterResult::Drop,
        1345 => FilterResult::Pass,
        1346 => FilterResult::Drop,
        1347 => FilterResult::Pass,
        1348 => FilterResult::Drop,
        1349 => FilterResult::Pass,
        1350 => FilterResult::Drop,
        1351 => FilterResult::Pass,
        1352 => FilterResult::Drop,
        1353 => FilterResult::Pass,
        1354 => FilterResult::Drop,
        1355 => FilterResult::Pass,
        1356 => FilterResult::Drop,
        1357 => FilterResult::Pass,
        1358 => FilterResult::Drop,
        1359 => FilterResult::Pass,
        1360 => FilterResult::Drop,
        1361 => FilterResult::Pass,
        1362 => FilterResult::Drop,
        1363 => FilterResult::Pass,
        1364 => FilterResult::Drop,
        1365 => FilterResult::Pass,
        1366 => FilterResult::Drop,
        1367 => FilterResult::Pass,
        1368 => FilterResult::Drop,
        1369 => FilterResult::Pass,
        1370 => FilterResult::Drop,
        1371 => FilterResult::Pass,
        1372 => FilterResult::Drop,
        1373 => FilterResult::Pass,
        1374 => FilterResult::Drop,
        1375 => FilterResult::Pass,
        1376 => FilterResult::Drop,
        1377 => FilterResult::Pass,
        1378 => FilterResult::Drop,
        1379 => FilterResult::Pass,
        1380 => FilterResult::Drop,
        1381 => FilterResult::Pass,
        1382 => FilterResult::Drop,
        1383 => FilterResult::Pass,
        1384 => FilterResult::Drop,
        1385 => FilterResult::Pass,
        1386 => FilterResult::Drop,
        1387 => FilterResult::Pass,
        1388 => FilterResult::Drop,
        1389 => FilterResult::Pass,
        1390 => FilterResult::Drop,
        1391 => FilterResult::Pass,
        1392 => FilterResult::Drop,
        1393 => FilterResult::Pass,
        1394 => FilterResult::Drop,
        1395 => FilterResult::Pass,
        1396 => FilterResult::Drop,
        1397 => FilterResult::Pass,
        1398 => FilterResult::Drop,
        1399 => FilterResult::Pass,
        1400 => FilterResult::Drop,
        1401 => FilterResult::Pass,
        1402 => FilterResult::Drop,
        1403 => FilterResult::Pass,
        1404 => FilterResult::Drop,
        1405 => FilterResult::Pass,
        1406 => FilterResult::Drop,
        1407 => FilterResult::Pass,
        1408 => FilterResult::Drop,
        1409 => FilterResult::Pass,
        1410 => FilterResult::Drop,
        1411 => FilterResult::Pass,
        1412 => FilterResult::Drop,
        1413 => FilterResult::Pass,
        1414 => FilterResult::Drop,
        1415 => FilterResult::Pass,
        1416 => FilterResult::Drop,
        1417 => FilterResult::Pass,
        1418 => FilterResult::Drop,
        1419 => FilterResult::Pass,
        1420 => FilterResult::Drop,
        1421 => FilterResult::Pass,
        1422 => FilterResult::Drop,
        1423 => FilterResult::Pass,
        1424 => FilterResult::Drop,
        1425 => FilterResult::Pass,
        1426 => FilterResult::Drop,
        1427 => FilterResult::Pass,
        1428 => FilterResult::Drop,
        1429 => FilterResult::Pass,
        1430 => FilterResult::Drop,
        1431 => FilterResult::Pass,
        1432 => FilterResult::Drop,
        1433 => FilterResult::Pass,
        1434 => FilterResult::Drop,
        1435 => FilterResult::Pass,
        1436 => FilterResult::Drop,
        1437 => FilterResult::Pass,
        1438 => FilterResult::Drop,
        1439 => FilterResult::Pass,
        1440 => FilterResult::Drop,
        1441 => FilterResult::Pass,
        1442 => FilterResult::Drop,
        1443 => FilterResult::Pass,
        1444 => FilterResult::Drop,
        1445 => FilterResult::Pass,
        1446 => FilterResult::Drop,
        1447 => FilterResult::Pass,
        1448 => FilterResult::Drop,
        1449 => FilterResult::Pass,
        1450 => FilterResult::Drop,
        1451 => FilterResult::Pass,
        1452 => FilterResult::Drop,
        1453 => FilterResult::Pass,
        1454 => FilterResult::Drop,
        1455 => FilterResult::Pass,
        1456 => FilterResult::Drop,
        1457 => FilterResult::Pass,
        1458 => FilterResult::Drop,
        1459 => FilterResult::Pass,
        1460 => FilterResult::Drop,
        1461 => FilterResult::Pass,
        1462 => FilterResult::Drop,
        1463 => FilterResult::Pass,
        1464 => FilterResult::Drop,
        1465 => FilterResult::Pass,
        1466 => FilterResult::Drop,
        1467 => FilterResult::Pass,
        1468 => FilterResult::Drop,
        1469 => FilterResult::Pass,
        1470 => FilterResult::Drop,
        1471 => FilterResult::Pass,
        1472 => FilterResult::Drop,
        1473 => FilterResult::Pass,
        1474 => FilterResult::Drop,
        1475 => FilterResult::Pass,
        1476 => FilterResult::Drop,
        1477 => FilterResult::Pass,
        1478 => FilterResult::Drop,
        1479 => FilterResult::Pass,
        1480 => FilterResult::Drop,
        1481 => FilterResult::Pass,
        1482 => FilterResult::Drop,
        1483 => FilterResult::Pass,
        1484 => FilterResult::Drop,
        1485 => FilterResult::Pass,
        1486 => FilterResult::Drop,
        1487 => FilterResult::Pass,
        1488 => FilterResult::Drop,
        1489 => FilterResult::Pass,
        1490 => FilterResult::Drop,
        1491 => FilterResult::Pass,
        1492 => FilterResult::Drop,
        1493 => FilterResult::Pass,
        1494 => FilterResult::Drop,
        1495 => FilterResult::Pass,
        1496 => FilterResult::Drop,
        1497 => FilterResult::Pass,
        1498 => FilterResult::Drop,
        1499 => FilterResult::Pass,
        1500 => FilterResult::Drop,
        1501 => FilterResult::Pass,
        1502 => FilterResult::Drop,
        1503 => FilterResult::Pass,
        1504 => FilterResult::Drop,
        1505 => FilterResult::Pass,
        1506 => FilterResult::Drop,
        1507 => FilterResult::Pass,
        1508 => FilterResult::Drop,
        1509 => FilterResult::Pass,
        1510 => FilterResult::Drop,
        1511 => FilterResult::Pass,
        1512 => FilterResult::Drop,
        1513 => FilterResult::Pass,
        1514 => FilterResult::Drop,
        1515 => FilterResult::Pass,
        1516 => FilterResult::Drop,
        1517 => FilterResult::Pass,
        1518 => FilterResult::Drop,
        1519 => FilterResult::Pass,
        1520 => FilterResult::Drop,
        1521 => FilterResult::Pass,
        1522 => FilterResult::Drop,
        1523 => FilterResult::Pass,
        1524 => FilterResult::Drop,
        1525 => FilterResult::Pass,
        1526 => FilterResult::Drop,
        1527 => FilterResult::Pass,
        1528 => FilterResult::Drop,
        1529 => FilterResult::Pass,
        1530 => FilterResult::Drop,
        1531 => FilterResult::Pass,
        1532 => FilterResult::Drop,
        1533 => FilterResult::Pass,
        1534 => FilterResult::Drop,
        1535 => FilterResult::Pass,
        1536 => FilterResult::Drop,
        1537 => FilterResult::Pass,
        1538 => FilterResult::Drop,
        1539 => FilterResult::Pass,
        1540 => FilterResult::Drop,
        1541 => FilterResult::Pass,
        1542 => FilterResult::Drop,
        1543 => FilterResult::Pass,
        1544 => FilterResult::Drop,
        1545 => FilterResult::Pass,
        1546 => FilterResult::Drop,
        1547 => FilterResult::Pass,
        1548 => FilterResult::Drop,
        1549 => FilterResult::Pass,
        1550 => FilterResult::Drop,
        1551 => FilterResult::Pass,
        1552 => FilterResult::Drop,
        1553 => FilterResult::Pass,
        1554 => FilterResult::Drop,
        1555 => FilterResult::Pass,
        1556 => FilterResult::Drop,
        1557 => FilterResult::Pass,
        1558 => FilterResult::Drop,
        1559 => FilterResult::Pass,
        1560 => FilterResult::Drop,
        1561 => FilterResult::Pass,
        1562 => FilterResult::Drop,
        1563 => FilterResult::Pass,
        1564 => FilterResult::Drop,
        1565 => FilterResult::Pass,
        1566 => FilterResult::Drop,
        1567 => FilterResult::Pass,
        1568 => FilterResult::Drop,
        1569 => FilterResult::Pass,
        1570 => FilterResult::Drop,
        1571 => FilterResult::Pass,
        1572 => FilterResult::Drop,
        1573 => FilterResult::Pass,
        1574 => FilterResult::Drop,
        1575 => FilterResult::Pass,
        1576 => FilterResult::Drop,
        1577 => FilterResult::Pass,
        1578 => FilterResult::Drop,
        1579 => FilterResult::Pass,
        1580 => FilterResult::Drop,
        1581 => FilterResult::Pass,
        1582 => FilterResult::Drop,
        1583 => FilterResult::Pass,
        1584 => FilterResult::Drop,
        1585 => FilterResult::Pass,
        1586 => FilterResult::Drop,
        1587 => FilterResult::Pass,
        1588 => FilterResult::Drop,
        1589 => FilterResult::Pass,
        1590 => FilterResult::Drop,
        1591 => FilterResult::Pass,
        1592 => FilterResult::Drop,
        1593 => FilterResult::Pass,
        1594 => FilterResult::Drop,
        1595 => FilterResult::Pass,
        1596 => FilterResult::Drop,
        1597 => FilterResult::Pass,
        1598 => FilterResult::Drop,
        1599 => FilterResult::Pass,
        1600 => FilterResult::Drop,
        1601 => FilterResult::Pass,
        1602 => FilterResult::Drop,
        1603 => FilterResult::Pass,
        1604 => FilterResult::Drop,
        1605 => FilterResult::Pass,
        1606 => FilterResult::Drop,
        1607 => FilterResult::Pass,
        1608 => FilterResult::Drop,
        1609 => FilterResult::Pass,
        1610 => FilterResult::Drop,
        1611 => FilterResult::Pass,
        1612 => FilterResult::Drop,
        1613 => FilterResult::Pass,
        1614 => FilterResult::Drop,
        1615 => FilterResult::Pass,
        1616 => FilterResult::Drop,
        1617 => FilterResult::Pass,
        1618 => FilterResult::Drop,
        1619 => FilterResult::Pass,
        1620 => FilterResult::Drop,
        1621 => FilterResult::Pass,
        1622 => FilterResult::Drop,
        1623 => FilterResult::Pass,
        1624 => FilterResult::Drop,
        1625 => FilterResult::Pass,
        1626 => FilterResult::Drop,
        1627 => FilterResult::Pass,
        1628 => FilterResult::Drop,
        1629 => FilterResult::Pass,
        1630 => FilterResult::Drop,
        1631 => FilterResult::Pass,
        1632 => FilterResult::Drop,
        1633 => FilterResult::Pass,
        1634 => FilterResult::Drop,
        1635 => FilterResult::Pass,
        1636 => FilterResult::Drop,
        1637 => FilterResult::Pass,
        1638 => FilterResult::Drop,
        1639 => FilterResult::Pass,
        1640 => FilterResult::Drop,
        1641 => FilterResult::Pass,
        1642 => FilterResult::Drop,
        1643 => FilterResult::Pass,
        1644 => FilterResult::Drop,
        1645 => FilterResult::Pass,
        1646 => FilterResult::Drop,
        1647 => FilterResult::Pass,
        1648 => FilterResult::Drop,
        1649 => FilterResult::Pass,
        1650 => FilterResult::Drop,
        1651 => FilterResult::Pass,
        1652 => FilterResult::Drop,
        1653 => FilterResult::Pass,
        1654 => FilterResult::Drop,
        1655 => FilterResult::Pass,
        1656 => FilterResult::Drop,
        1657 => FilterResult::Pass,
        1658 => FilterResult::Drop,
        1659 => FilterResult::Pass,
        1660 => FilterResult::Drop,
        1661 => FilterResult::Pass,
        1662 => FilterResult::Drop,
        1663 => FilterResult::Pass,
        1664 => FilterResult::Drop,
        1665 => FilterResult::Pass,
        1666 => FilterResult::Drop,
        1667 => FilterResult::Pass,
        1668 => FilterResult::Drop,
        1669 => FilterResult::Pass,
        1670 => FilterResult::Drop,
        1671 => FilterResult::Pass,
        1672 => FilterResult::Drop,
        1673 => FilterResult::Pass,
        1674 => FilterResult::Drop,
        1675 => FilterResult::Pass,
        1676 => FilterResult::Drop,
        1677 => FilterResult::Pass,
        1678 => FilterResult::Drop,
        1679 => FilterResult::Pass,
        1680 => FilterResult::Drop,
        1681 => FilterResult::Pass,
        1682 => FilterResult::Drop,
        1683 => FilterResult::Pass,
        1684 => FilterResult::Drop,
        1685 => FilterResult::Pass,
        1686 => FilterResult::Drop,
        1687 => FilterResult::Pass,
        1688 => FilterResult::Drop,
        1689 => FilterResult::Pass,
        1690 => FilterResult::Drop,
        1691 => FilterResult::Pass,
        1692 => FilterResult::Drop,
        1693 => FilterResult::Pass,
        1694 => FilterResult::Drop,
        1695 => FilterResult::Pass,
        1696 => FilterResult::Drop,
        1697 => FilterResult::Pass,
        1698 => FilterResult::Drop,
        1699 => FilterResult::Pass,
        1700 => FilterResult::Drop,
        1701 => FilterResult::Pass,
        1702 => FilterResult::Drop,
        1703 => FilterResult::Pass,
        1704 => FilterResult::Drop,
        1705 => FilterResult::Pass,
        1706 => FilterResult::Drop,
        1707 => FilterResult::Pass,
        1708 => FilterResult::Drop,
        1709 => FilterResult::Pass,
        1710 => FilterResult::Drop,
        1711 => FilterResult::Pass,
        1712 => FilterResult::Drop,
        1713 => FilterResult::Pass,
        1714 => FilterResult::Drop,
        1715 => FilterResult::Pass,
        1716 => FilterResult::Drop,
        1717 => FilterResult::Pass,
        1718 => FilterResult::Drop,
        1719 => FilterResult::Pass,
        1720 => FilterResult::Drop,
        1721 => FilterResult::Pass,
        1722 => FilterResult::Drop,
        1723 => FilterResult::Pass,
        1724 => FilterResult::Drop,
        1725 => FilterResult::Pass,
        1726 => FilterResult::Drop,
        1727 => FilterResult::Pass,
        1728 => FilterResult::Drop,
        1729 => FilterResult::Pass,
        1730 => FilterResult::Drop,
        1731 => FilterResult::Pass,
        1732 => FilterResult::Drop,
        1733 => FilterResult::Pass,
        1734 => FilterResult::Drop,
        1735 => FilterResult::Pass,
        1736 => FilterResult::Drop,
        1737 => FilterResult::Pass,
        1738 => FilterResult::Drop,
        1739 => FilterResult::Pass,
        1740 => FilterResult::Drop,
        1741 => FilterResult::Pass,
        1742 => FilterResult::Drop,
        1743 => FilterResult::Pass,
        1744 => FilterResult::Drop,
        1745 => FilterResult::Pass,
        1746 => FilterResult::Drop,
        1747 => FilterResult::Pass,
        1748 => FilterResult::Drop,
        1749 => FilterResult::Pass,
        1750 => FilterResult::Drop,
        1751 => FilterResult::Pass,
        1752 => FilterResult::Drop,
        1753 => FilterResult::Pass,
        1754 => FilterResult::Drop,
        1755 => FilterResult::Pass,
        1756 => FilterResult::Drop,
        1757 => FilterResult::Pass,
        1758 => FilterResult::Drop,
        1759 => FilterResult::Pass,
        1760 => FilterResult::Drop,
        1761 => FilterResult::Pass,
        1762 => FilterResult::Drop,
        1763 => FilterResult::Pass,
        1764 => FilterResult::Drop,
        1765 => FilterResult::Pass,
        1766 => FilterResult::Drop,
        1767 => FilterResult::Pass,
        1768 => FilterResult::Drop,
        1769 => FilterResult::Pass,
        1770 => FilterResult::Drop,
        1771 => FilterResult::Pass,
        1772 => FilterResult::Drop,
        1773 => FilterResult::Pass,
        1774 => FilterResult::Drop,
        1775 => FilterResult::Pass,
        1776 => FilterResult::Drop,
        1777 => FilterResult::Pass,
        1778 => FilterResult::Drop,
        1779 => FilterResult::Pass,
        1780 => FilterResult::Drop,
        1781 => FilterResult::Pass,
        1782 => FilterResult::Drop,
        1783 => FilterResult::Pass,
        1784 => FilterResult::Drop,
        1785 => FilterResult::Pass,
        1786 => FilterResult::Drop,
        1787 => FilterResult::Pass,
        1788 => FilterResult::Drop,
        1789 => FilterResult::Pass,
        1790 => FilterResult::Drop,
        1791 => FilterResult::Pass,
        1792 => FilterResult::Drop,
        1793 => FilterResult::Pass,
        1794 => FilterResult::Drop,
        1795 => FilterResult::Pass,
        1796 => FilterResult::Drop,
        1797 => FilterResult::Pass,
        1798 => FilterResult::Drop,
        1799 => FilterResult::Pass,
        1800 => FilterResult::Drop,
        1801 => FilterResult::Pass,
        1802 => FilterResult::Drop,
        1803 => FilterResult::Pass,
        1804 => FilterResult::Drop,
        1805 => FilterResult::Pass,
        1806 => FilterResult::Drop,
        1807 => FilterResult::Pass,
        1808 => FilterResult::Drop,
        1809 => FilterResult::Pass,
        1810 => FilterResult::Drop,
        1811 => FilterResult::Pass,
        1812 => FilterResult::Drop,
        1813 => FilterResult::Pass,
        1814 => FilterResult::Drop,
        1815 => FilterResult::Pass,
        1816 => FilterResult::Drop,
        1817 => FilterResult::Pass,
        1818 => FilterResult::Drop,
        1819 => FilterResult::Pass,
        1820 => FilterResult::Drop,
        1821 => FilterResult::Pass,
        1822 => FilterResult::Drop,
        1823 => FilterResult::Pass,
        1824 => FilterResult::Drop,
        1825 => FilterResult::Pass,
        1826 => FilterResult::Drop,
        1827 => FilterResult::Pass,
        1828 => FilterResult::Drop,
        1829 => FilterResult::Pass,
        1830 => FilterResult::Drop,
        1831 => FilterResult::Pass,
        1832 => FilterResult::Drop,
        1833 => FilterResult::Pass,
        1834 => FilterResult::Drop,
        1835 => FilterResult::Pass,
        1836 => FilterResult::Drop,
        1837 => FilterResult::Pass,
        1838 => FilterResult::Drop,
        1839 => FilterResult::Pass,
        1840 => FilterResult::Drop,
        1841 => FilterResult::Pass,
        1842 => FilterResult::Drop,
        1843 => FilterResult::Pass,
        1844 => FilterResult::Drop,
        1845 => FilterResult::Pass,
        1846 => FilterResult::Drop,
        1847 => FilterResult::Pass,
        1848 => FilterResult::Drop,
        1849 => FilterResult::Pass,
        1850 => FilterResult::Drop,
        1851 => FilterResult::Pass,
        1852 => FilterResult::Drop,
        1853 => FilterResult::Pass,
        1854 => FilterResult::Drop,
        1855 => FilterResult::Pass,
        1856 => FilterResult::Drop,
        1857 => FilterResult::Pass,
        1858 => FilterResult::Drop,
        1859 => FilterResult::Pass,
        1860 => FilterResult::Drop,
        1861 => FilterResult::Pass,
        1862 => FilterResult::Drop,
        1863 => FilterResult::Pass,
        1864 => FilterResult::Drop,
        1865 => FilterResult::Pass,
        1866 => FilterResult::Drop,
        1867 => FilterResult::Pass,
        1868 => FilterResult::Drop,
        1869 => FilterResult::Pass,
        1870 => FilterResult::Drop,
        1871 => FilterResult::Pass,
        1872 => FilterResult::Drop,
        1873 => FilterResult::Pass,
        1874 => FilterResult::Drop,
        1875 => FilterResult::Pass,
        1876 => FilterResult::Drop,
        1877 => FilterResult::Pass,
        1878 => FilterResult::Drop,
        1879 => FilterResult::Pass,
        1880 => FilterResult::Drop,
        1881 => FilterResult::Pass,
        1882 => FilterResult::Drop,
        1883 => FilterResult::Pass,
        1884 => FilterResult::Drop,
        1885 => FilterResult::Pass,
        1886 => FilterResult::Drop,
        1887 => FilterResult::Pass,
        1888 => FilterResult::Drop,
        1889 => FilterResult::Pass,
        1890 => FilterResult::Drop,
        1891 => FilterResult::Pass,
        1892 => FilterResult::Drop,
        1893 => FilterResult::Pass,
        1894 => FilterResult::Drop,
        1895 => FilterResult::Pass,
        1896 => FilterResult::Drop,
        1897 => FilterResult::Pass,
        1898 => FilterResult::Drop,
        1899 => FilterResult::Pass,
        1900 => FilterResult::Drop,
        1901 => FilterResult::Pass,
        1902 => FilterResult::Drop,
        1903 => FilterResult::Pass,
        1904 => FilterResult::Drop,
        1905 => FilterResult::Pass,
        1906 => FilterResult::Drop,
        1907 => FilterResult::Pass,
        1908 => FilterResult::Drop,
        1909 => FilterResult::Pass,
        1910 => FilterResult::Drop,
        1911 => FilterResult::Pass,
        1912 => FilterResult::Drop,
        1913 => FilterResult::Pass,
        1914 => FilterResult::Drop,
        1915 => FilterResult::Pass,
        1916 => FilterResult::Drop,
        1917 => FilterResult::Pass,
        1918 => FilterResult::Drop,
        1919 => FilterResult::Pass,
        1920 => FilterResult::Drop,
        1921 => FilterResult::Pass,
        1922 => FilterResult::Drop,
        1923 => FilterResult::Pass,
        1924 => FilterResult::Drop,
        1925 => FilterResult::Pass,
        1926 => FilterResult::Drop,
        1927 => FilterResult::Pass,
        1928 => FilterResult::Drop,
        1929 => FilterResult::Pass,
        1930 => FilterResult::Drop,
        1931 => FilterResult::Pass,
        1932 => FilterResult::Drop,
        1933 => FilterResult::Pass,
        1934 => FilterResult::Drop,
        1935 => FilterResult::Pass,
        1936 => FilterResult::Drop,
        1937 => FilterResult::Pass,
        1938 => FilterResult::Drop,
        1939 => FilterResult::Pass,
        1940 => FilterResult::Drop,
        1941 => FilterResult::Pass,
        1942 => FilterResult::Drop,
        1943 => FilterResult::Pass,
        1944 => FilterResult::Drop,
        1945 => FilterResult::Pass,
        1946 => FilterResult::Drop,
        1947 => FilterResult::Pass,
        1948 => FilterResult::Drop,
        1949 => FilterResult::Pass,
        1950 => FilterResult::Drop,
        1951 => FilterResult::Pass,
        1952 => FilterResult::Drop,
        1953 => FilterResult::Pass,
        1954 => FilterResult::Drop,
        1955 => FilterResult::Pass,
        1956 => FilterResult::Drop,
        1957 => FilterResult::Pass,
        1958 => FilterResult::Drop,
        1959 => FilterResult::Pass,
        1960 => FilterResult::Drop,
        1961 => FilterResult::Pass,
        1962 => FilterResult::Drop,
        1963 => FilterResult::Pass,
        1964 => FilterResult::Drop,
        1965 => FilterResult::Pass,
        1966 => FilterResult::Drop,
        1967 => FilterResult::Pass,
        1968 => FilterResult::Drop,
        1969 => FilterResult::Pass,
        1970 => FilterResult::Drop,
        1971 => FilterResult::Pass,
        1972 => FilterResult::Drop,
        1973 => FilterResult::Pass,
        1974 => FilterResult::Drop,
        1975 => FilterResult::Pass,
        1976 => FilterResult::Drop,
        1977 => FilterResult::Pass,
        1978 => FilterResult::Drop,
        1979 => FilterResult::Pass,
        1980 => FilterResult::Drop,
        1981 => FilterResult::Pass,
        1982 => FilterResult::Drop,
        1983 => FilterResult::Pass,
        1984 => FilterResult::Drop,
        1985 => FilterResult::Pass,
        1986 => FilterResult::Drop,
        1987 => FilterResult::Pass,
        1988 => FilterResult::Drop,
        1989 => FilterResult::Pass,
        1990 => FilterResult::Drop,
        1991 => FilterResult::Pass,
        1992 => FilterResult::Drop,
        1993 => FilterResult::Pass,
        1994 => FilterResult::Drop,
        1995 => FilterResult::Pass,
        1996 => FilterResult::Drop,
        1997 => FilterResult::Pass,
        1998 => FilterResult::Drop,
        1999 => FilterResult::Pass,
        2000 => FilterResult::Drop,
        2001 => FilterResult::Pass,
        2002 => FilterResult::Drop,
        2003 => FilterResult::Pass,
        2004 => FilterResult::Drop,
        2005 => FilterResult::Pass,
        2006 => FilterResult::Drop,
        2007 => FilterResult::Pass,
        2008 => FilterResult::Drop,
        2009 => FilterResult::Pass,
        2010 => FilterResult::Drop,
        2011 => FilterResult::Pass,
        2012 => FilterResult::Drop,
        2013 => FilterResult::Pass,
        2014 => FilterResult::Drop,
        2015 => FilterResult::Pass,
        2016 => FilterResult::Drop,
        2017 => FilterResult::Pass,
        2018 => FilterResult::Drop,
        2019 => FilterResult::Pass,
        2020 => FilterResult::Drop,
        2021 => FilterResult::Pass,
        2022 => FilterResult::Drop,
        2023 => FilterResult::Pass,
        2024 => FilterResult::Drop,
        2025 => FilterResult::Pass,
        2026 => FilterResult::Drop,
        2027 => FilterResult::Pass,
        2028 => FilterResult::Drop,
        2029 => FilterResult::Pass,
        2030 => FilterResult::Drop,
        2031 => FilterResult::Pass,
        2032 => FilterResult::Drop,
        2033 => FilterResult::Pass,
        2034 => FilterResult::Drop,
        2035 => FilterResult::Pass,
        2036 => FilterResult::Drop,
        2037 => FilterResult::Pass,
        2038 => FilterResult::Drop,
        2039 => FilterResult::Pass,
        2040 => FilterResult::Drop,
        2041 => FilterResult::Pass,
        2042 => FilterResult::Drop,
        2043 => FilterResult::Pass,
        2044 => FilterResult::Drop,
        2045 => FilterResult::Pass,
        2046 => FilterResult::Drop,
        2047 => FilterResult::Pass,
        2048 => FilterResult::Drop,
        2049 => FilterResult::Pass,
        2050 => FilterResult::Drop,
        2051 => FilterResult::Pass,
        2052 => FilterResult::Drop,
        2053 => FilterResult::Pass,
        2054 => FilterResult::Drop,
        2055 => FilterResult::Pass,
        2056 => FilterResult::Drop,
        2057 => FilterResult::Pass,
        2058 => FilterResult::Drop,
        2059 => FilterResult::Pass,
        2060 => FilterResult::Drop,
        2061 => FilterResult::Pass,
        2062 => FilterResult::Drop,
        2063 => FilterResult::Pass,
        2064 => FilterResult::Drop,
        2065 => FilterResult::Pass,
        2066 => FilterResult::Drop,
        2067 => FilterResult::Pass,
        2068 => FilterResult::Drop,
        2069 => FilterResult::Pass,
        2070 => FilterResult::Drop,
        2071 => FilterResult::Pass,
        2072 => FilterResult::Drop,
        2073 => FilterResult::Pass,
        2074 => FilterResult::Drop,
        2075 => FilterResult::Pass,
        2076 => FilterResult::Drop,
        2077 => FilterResult::Pass,
        2078 => FilterResult::Drop,
        2079 => FilterResult::Pass,
        2080 => FilterResult::Drop,
        2081 => FilterResult::Pass,
        2082 => FilterResult::Drop,
        2083 => FilterResult::Pass,
        2084 => FilterResult::Drop,
        2085 => FilterResult::Pass,
        2086 => FilterResult::Drop,
        2087 => FilterResult::Pass,
        2088 => FilterResult::Drop,
        2089 => FilterResult::Pass,
        2090 => FilterResult::Drop,
        2091 => FilterResult::Pass,
        2092 => FilterResult::Drop,
        2093 => FilterResult::Pass,
        2094 => FilterResult::Drop,
        2095 => FilterResult::Pass,
        2096 => FilterResult::Drop,
        2097 => FilterResult::Pass,
        2098 => FilterResult::Drop,
        2099 => FilterResult::Pass,
        2100 => FilterResult::Drop,
        _ => FilterResult::Drop,
    })
}
